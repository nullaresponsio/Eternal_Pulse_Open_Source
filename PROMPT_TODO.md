Provide the full upgrade scanner.py file; We are going to create an enhanced version of the scanner.py file with the following improvements:
 1. **Evasion Techniques**: We already have several evasion techniques (fragmentation, session corruption, etc.) but we can add more and improve existing ones.
 2. **Backdoor Installation**: We have a method to simulate backdoor installation. We can expand this to include more methods and persistence.
 3. **Stealth and Randomization**: Add jitter, random delays, and randomize the order of scans to avoid pattern detection.
 4. **Protocol Fuzzing**: Use genetic algorithms to evolve fuzzing payloads for SMB and other protocols.
 5. **Service Fingerprinting**: Beyond port scanning, attempt to fingerprint services (SMB version, OS, etc.).
 6. **Reporting**: Enhance the reporting to include more details and vulnerabilities.
 7. **Modular Design**: Break down the scanner into more modular components for easier maintenance and extension.
 8. **Error Handling**: Improve error handling and logging.
 9. **Command and Control (C2) Simulation**: Simulate C2 communication for installed backdoors.: Enhance capabilities in all possible ways at once; think creatively and do as great a job as you can: 

 